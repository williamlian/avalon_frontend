<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />

    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
    <meta http-equiv="Content-Security-Policy" content="default-src *; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval'">

    <!-- Makes your prototype chrome-less once bookmarked to your phone's home screen -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <script type="text/javascript">
        window.onerror = function(message, url, lineNumber) {  
          console.log("ERROR: " + message + " at " + url + ":" + lineNumber);
          return false;
        };
    </script>

    <script type="text/javascript" src="cordova.js"></script>
    <script src="lib/jquery.js"></script>
    <script src="lib/fastclick.js"></script>
    <script src="lib/handlebars.js"></script>
    <script src="assets/ratchet/js/ratchet.js"></script>

    <link href="assets/ratchet/css/ratchet.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/index.css" />

    <link rel="apple-touch-icon" href="apple-touch-icon.png" />

    <title>Avalon</title>
</head>

<body>

    <script id="home-tpl" type="text/template">
        <header class="bar bar-nav">
            <h1 class="title">Avalon</h1>
        </header>
        <nav class="bar bar-header-secondary">
            <div class="segmented-control">
                <span class="control-item active" id="new">New Game</span>
                <span class="control-item" id="join">Join Game</span>
            </div>
        </nav>
        <div class="content">
        </div>
    </script>
    <script id="new-subtpl" type="text/template">
        <div class="card padded-card">
            <p>Create a new game by entering the game size</p>
            <input type="text" placeholder="Group Size" id="size">
            <button class="btn btn-primary btn-block" id="create">Create</button>
        </div>
    </script>
    <script id="join-subtpl" type="text/template">
        <div class="card padded-card">
            <p>Join a room by group number</p>
            <input type="text" placeholder="Room Number" id="group_id">
            <button class="btn btn-primary btn-block" id="join">Join</button>
        </form>
    </script>

    <script id="character-tpl" type="text/template">
        <header class="bar bar-nav">
            <a class="icon icon-left-nav pull-left" id="back"></a>
            <h1 class="title">Select Characters</h1>
        </header>
        <nav class="bar bar-header-secondary vertical-center-parent">
            <p class="character-count vertical-center-child">
            <span id="select-count">0</span> Selected</p>
        </nav>
        <div class="bar bar-standard bar-footer">
            <button class="btn btn-primary btn-block" id="submit">Submit</button>
        </div>
        <div class="content">
            <ul class="table-view content-list">
                {{#each this}}
                <li class="table-view-cell character" name="{{ this.key }}">
                    <div class="character-item">
                        <span class="{{ this.side }}"/>
                        {{ this.name }}
                    </div>
                    <div class="toggle">
                        <div class="toggle-handle"></div>
                    </div>
                </li>
                {{/each}}
            </ul>
        </div>
    </script>

    <script id="ready-tpl" type="text/template">
        <header class="bar bar-nav">
            <h1 class="title">Get Ready</h1>
        </header>
        <div class="content">
            <ul class="table-view content-list">
                <li class="table-view-cell">
                    <strong class="pull-left">Group ID</strong>
                    <div class="pull-right">{{ group.id }}</div>
                </li>
                <li class="table-view-cell">
                    <strong class="pull-left">Players</strong>
                    <div class="pull-right">{{ group.player_count }}</div>
                </li>
                <li class="table-view-cell">
                    <strong class="pull-left">Group Size</strong>
                    <div class="pull-right">{{ group.size }}</div>
                </li>
                <li class="table-view-cell">
                    <strong class="pull-left">Character</strong>
                    <div class="pull-right">{{ player.character }}</div>
                </li>
            </ul>
            <div class="card padded-card">
                <p>Type in your name to get ready</p>
                <input type="text" placeholder="Name" id="name">
                <button class="btn btn-primary btn-block" id="ready">Ready</button>
            </div>
        </div>
    </script>

    <script id="game-tpl" type="text/template">
        <header class="bar bar-nav">
            <h1 class="title">Playing</h1>
        </header>
        {{#if can_choose_knights}}
        <nav class="bar bar-header-secondary">
            <button class="btn btn-primary btn-block" id="king">
                Choose Knights
            </button>
        </nav>
        {{/if}}
        <div class="bar bar-secondary bar-footer">
            <button class="btn btn-negative btn-block" id="quit">
                Quit
            </button>
        </div>
        <div class="content game-view">
            <ul class="table-view">
                <li class="table-view-cell">
                    <strong class="pull-left">Group ID</strong>
                    <div class="pull-right">{{ group.id }}</div>
                </li>
                <li class="table-view-cell">
                    <strong class="pull-left">Players</strong>
                    <div class="pull-right">{{ group.player_count }}</div>
                </li>
                <li class="table-view-cell">
                    <strong class="pull-left">Group Size</strong>
                    <div class="pull-right">{{ group.size }}</div>
                </li>
                <li class="table-view-cell">
                    <strong class="pull-left">Character</strong>
                    <div class="pull-right">{{ player.character }}</div>
                </li>
                <li class="table-view-cell">
                    <strong class="pull-left">Quest Result</strong>
                    <div class="pull-right">
                        Success: {{ group.quest_result.success }}
                        Fail: {{ group.quest_result.failed }}
                    </div>
                </li>
            </ul>
            <ul class="table-view">
                {{#each group.players}}
                <li class="table-view-cell media">
                    <p>{{ this.name }}</p>
                    <p>{{ this.character }}</p>
                    {{#if this.is_king}}
                        <p>King</p>
                    {{/if}}
                </li>
                {{/each}}
            </ul>
        </div>
    </script>

    <script id="king-tpl" type="text/template">
        <header class="bar bar-nav">
            <h1 class="title">Choose Your Knights</h1>
        </header>
        <nav class="bar bar-header-secondary">
            <p style="text-align: center;"><span id="knight-count">0</span> Selected</p>
        </nav>
        <div class="bar bar-secondary bar-footer">
            <button class="btn btn-primary btn-block" id="start-vote">Start Vote</button>
        </div>
        <div class="content">
            <ul class="table-view">
                {{#each group.players}}
                <li class="table-view-cell knight" name="{{ this.player_sequence }}">
                    <div>
                        <p>{{ this.name }}</p>
                        <p>{{ this.character }}</p>
                    </div>
                    <div class="toggle">
                        <div class="toggle-handle"></div>
                    </div>
                </li>
                {{/each}}
            </ul>
        </div>
    </script>

    <script id="vote-tpl" type="text/template">
        <header class="bar bar-nav">
            <h1 class="title">Vote</h1>
        </header>
        <nav class="bar bar-header-secondary">
            <p style="text-align: center;">
                Vote Result:
                {{vote_result}}
            </p>
        </nav>
        <div class="bar bar-secondary bar-footer">
            {{#if is_voting}}
            <table width="100%">
                <tr>
                    <td>
                        <button class="btn btn-primary btn-block" id="accept">Accept</button>
                    </td>
                    <td>
                        <button class="btn btn-negative btn-block" id="reject">Reject</button>
                    </td>
                </tr>
            </table>
            {{/if}}
            {{#if show_start}}
            <button class="btn btn-primary btn-block" id="start-quest">Start Quest</button>
            {{/if}}
            {{#if show_skip}}
            <button class="btn btn-negative btn-block" id="end-turn">End Turn</button>
            {{/if}}
            {{#if show_voter}}
            <p>Please wait for the vote completes.</p>
            {{/if}}
        </div>
        <div class="content">
            <ul class="table-view">
                {{#each group.players}}
                <li class="table-view-cell media">
                    <p>{{ this.name }}</p>
                    <p>{{ this.character }}</p>
                    {{#if this.is_knight}}
                        <p>Knight</p>
                    {{/if}}
                    <p>{{ this.last_vote }}</p>
                </li>
                {{/each}}
            </ul>
        </div>
    </script>

    <script id="quest-tpl" type="text/template">
        <header class="bar bar-nav">
            <h1 class="title">Take Your Quest</h1>
        </header>
        <div class="bar bar-secondary bar-footer">
            <table width="100%">
                <tr>
                    <td>
                        <button class="btn btn-primary btn-block" id="success">Success</button>
                    </td>
                    <td>
                        <button class="btn btn-negative btn-block" id="fail">Fail</button>
                    </td>
                </tr>
            </table>
        </div>
        <div class="content">
            <ul class="table-view">
                {{#each group.players}}
                {{#if this.is_knight}}
                    <li class="table-view-cell media">
                        <p>{{ this.name }}</p>
                        <p>{{ this.character }}</p>
                    </li>
                {{/if}}
                {{/each}}
            </ul>
        </div>
    </script>

    <script type="text/javascript" src="lib/router.js"></script>
    <script type="text/javascript" src="js/services/AvalonService.js"></script>

    <script type="text/javascript" src="js/views/HomeView.js"></script>
    <script type="text/javascript" src="js/views/ReadyView.js"></script>
    <script type="text/javascript" src="js/views/CharacterView.js"></script>
    <script type="text/javascript" src="js/views/GameView.js"></script>
    <script type="text/javascript" src="js/views/KingView.js"></script>
    <script type="text/javascript" src="js/views/VoteView.js"></script>
    <script type="text/javascript" src="js/views/QuestView.js"></script>

    <script type="text/javascript" src="js/helper/CharacterPresenter.js"></script>

    <script type="text/javascript" src="js/index.js"></script>

</body>

</html>